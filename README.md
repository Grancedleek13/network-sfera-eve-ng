# Корпоративная сеть «Сфера» (EVE‑NG Lab)

Учебный мини‑проект по моделированию сети небольшой компании в **EVE‑NG**.

Реализовано:

- сегментация сети по VLAN (маркетинг, HR, серверная);
- маршрутизация по схеме *router‑on‑a‑stick*;
- изоляция отделов (ACL между VLAN10 и VLAN20);
- доступ к серверной VLAN из обоих отделов;
- NAT (SNAT) для выхода во внешнюю сеть через адрес `203.0.113.5`;
- DNAT для публикации веб‑сервера из VLAN30;
- документация: схема, план адресации, план коммутации, результаты тестов.

## Структура репозитория

```text
sfera-network-lab/
├── topology/
│   ├── drawio-network-diagram.drawio     # логическая схема сети (draw.io)
│   └── topology-notes.md                 # пояснения по топологии
├── configs/
│   ├── router-config.txt                 # конфиг маршрутизатора
│   ├── switch-config.txt                 # конфиг L2-коммутатора
│   └── web-server-info.md                # заметки по веб-серверу
├── docs/
│   ├── architecture.md                   # общее описание архитектуры
│   ├── addressing-plan.md                # план адресации
│   ├── vlan-plan.md                      # VLAN'ы и их назначение
│   ├── switching-plan.md                 # план коммутации
│   └── testing-results.md                # проверки работоспособности
└── README.md
```

---

## Архитектура

Компания «Сфера» имеет три логических сегмента в одном офисе:

- **VLAN10 – Маркетинг** (~30 рабочих мест);
- **VLAN20 – HR** (~25 рабочих мест);
- **VLAN30 – Серверная** (3 сервера, один из них – веб‑сервер).

Маршрутизация между VLAN выполняется на маршрутизаторе по схеме *router‑on‑a‑stick* (dot1q‑транк от SW1 к Router).  
Выход в Интернет и публикация веб‑сервера осуществляются через провайдера (узел ISP).

Схема сети (логическая топология) хранится в `topology/drawio-network-diagram.drawio`
и может быть открыта через [draw.io / diagrams.net](https://app.diagrams.net).

Пример вставки схемы в README (если экспортировать её в PNG):

```markdown
![Network topology](topology/network-topology.png)
```

---

## Краткий план адресации

Внутреннее адресное пространство: `192.168.60.0/24`, делим на подсети:

- **VLAN10 (Маркетинг)** – `192.168.60.0/26`
  - Диапазон хостов: `192.168.60.1–192.168.60.62`
  - Шлюз: `192.168.60.1` (Router subif e0/0.10)

- **VLAN20 (HR)** – `192.168.60.64/26`
  - Диапазон хостов: `192.168.60.65–192.168.60.126`
  - Шлюз: `192.168.60.65` (Router subif e0/0.20)

- **VLAN30 (Серверная)** – `192.168.60.128/27`
  - Диапазон хостов: `192.168.60.129–192.168.60.158`
  - Шлюз: `192.168.60.129` (Router subif e0/0.30)

Примеры адресов:

- PC1 (Маркетинг): `192.168.60.10/26`, GW `192.168.60.1`
- PC2 (HR): `192.168.60.70/26`, GW `192.168.60.65`
- WEB-SRV (сервер): `192.168.60.130/27`, GW `192.168.60.129`

Провайдер и внешняя сеть:

- Линк Router–ISP: `203.0.113.4/30` (пример)
  - Router: `203.0.113.5`
  - ISP: `203.0.113.6`
- Публичный адрес компании: `203.0.113.5` (используется для NAT).

---

## NAT

### SNAT

Все хосты из VLAN10/20/30 выходят в Интернет через один публичный IP:

```text
ip nat inside source list NAT-LAN interface Ethernet0/2 overload
```

где в ACL `NAT-LAN` перечислены внутренние сети `192.168.60.0/24`.

### DNAT (публикация веб‑сервера)

Веб‑сервер `192.168.60.130` из VLAN30 опубликован наружу на `203.0.113.5:80`
через статический NAT (пример для IOS):

```text
ip nat inside source static tcp 192.168.60.130 80 203.0.113.5 80
```

---

## ACL: изоляция отделов

Между VLAN10 (Маркетинг) и VLAN20 (HR) настроены ACL, запрещающие прямой трафик
между хостами отделов, при этом доступ к серверной VLAN30 и в Интернет разрешён.

Пример:

```text
ip access-list extended VLAN10-IN
 deny ip 192.168.60.0 0.0.0.63 192.168.60.64 0.0.0.63
 permit ip any any

ip access-list extended VLAN20-IN
 deny ip 192.168.60.64 0.0.0.63 192.168.60.0 0.0.0.63
 permit ip any any
```

ACL применяются к подинтерфейсам e0/0.10 и e0/0.20 во входящем направлении.

---

## Проверки

Подробные тесты описаны в `docs/testing-results.md`, но основная логика такая:

- PC1 (VLAN10) **не пингует** PC2 (VLAN20) – отделы изолированы;
- PC1 и PC2 **пингуют** WEB-SRV (VLAN30) – доступ к серверу есть;
- WEB-SRV пингует PC1/PC2 и шлюзы – маршрутизация и VLAN корректны;
- с хостов внутренних VLAN выполняется `ping 203.0.113.6` (или 8.8.8.8) – Интернет работает;
- извне (со стороны ISP) доступен `203.0.113.5:80` – веб‑сервер опубликован.

---

## Как использовать этот проект

1. Развернуть EVE‑NG (community или pro).
2. Импортировать/создать топологию по схеме `topology/drawio-network-diagram.drawio`.
3. Настроить устройства по конфигам из папки `configs/`.
4. Выполнить проверки из `docs/testing-results.md`.
5. При желании – модифицировать адресацию, ACL или логику NAT под свои задачи.

---

## Идеи для развития

- добавить второй офис и связать их через GRE/IPsec;
- ввести динамическую маршрутизацию (OSPF/EIGRP) вместо статических маршрутов;
- вынести DHCP на отдельный сервер;
- реализовать резервирование шлюза (HSRP/VRRP) и агрегацию линков.